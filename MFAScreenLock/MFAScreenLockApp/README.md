# MFAScreenLock
用谷歌验证器锁定 Windows 屏幕，防止远程桌面未授权访问。

## 安装
- 依赖
  - `Windows ≥ 7 SP1 （x 86 和 x64）`
  - `Windows Server ≥ 2008 R2 SP1 (x64)`
  - `.NET Framework ≥ 4.6.2`
    - 下载： `https://support.microsoft.com/zh-cn/help/3151800/the-net-framework-4-6-2-offline-installer-for-windows`
- 解压缩文件到用户文件夹中。
  - 如果你不主动进行文件权限配置，则强烈推荐解压缩到用户文件夹中，防止被其他用户访问到密码文件。
- 运行 `MFAScreenLockApp.exe` 。

## 配置

- 直接运行，如果没有绑定过任何验证器，将出现设置画面。此时点击绑定按钮。
- 确认显示的时间日期和时区与手机完全同步。
- 使用 MFA APP 扫描二维码。
  - 也可以手工抄写右上方显示的密钥进验证器。
  - 注意：如果此计算机计算机名、用户域和同户名和其他计算机相同，其他计算机上的登录信息将被覆盖！如果出现此情况，请在扫码绑定之前修改你的计算机名称并重新启动计算机。
- 输入验证器上显示的代码，点击完成绑定。
- 记下屏幕上显示的恢复代码。
  - 点击「是」之后恢复代码将复制到剪贴板，一旦无法使用动态密码，可以使用此恢复代码进入。
  - 点击「否」将不产生恢复代码，虽然更安全，但是手机损坏、丢失、验证APP卸载、验证APP数据丢失等情况发生时，将会导致无法登入。
- 绑定信息将会显示计算机名、用户域和同户名。
  - 注意：计算机名、用户域和同户名是绑定的，如果修改其中之一将会无法登入。如需修改，请先解绑验证器。
- 点击完成按钮。
- 在计划任务中将本程序进行开机启动。 
  - 可以在启动参数中加入 `-e` ，程序将在解除锁定后立即退出（否则会驻留图标在状态栏），以便利用计划任务提供的闲置时长功能来进行自动锁定。
    - 例如：`MFAScreenLockApp.exe -e`

## 使用
- 下次运行本程序时，计算机画面将被锁定，此时请输入验证器中显示的动态密码，或者恢复代码。
  - 如果正确，将直接解锁，无需使用回车键。
  - 解锁画面显示的背景图像为你的首选显示器桌面壁纸。
  - 其他非首选显示器将显示空白桌面壁纸。
- 解锁后，会驻留图标在状态栏，右键点击可弹出菜单，可以随时立即上锁、修改绑定，以及退出。
  - 这些菜单项在点击后，会重新进入一次密码输入状态，以验证是本人，之后才继续执行所选择的菜单命令。

## 解绑
- 方法1：不加 `-e` 参数运行的情况下，输入密码或恢复代码解锁，在任务栏驻留的图标上点右键，选「绑定管理」，选择「解绑」，然后退出软件。
- 方法2：在程序完全退出的情况下，带 `-r <恢复代码>` 参数启动程序，确认后可直接清除软件所有设置，包括密码。软件将自动退出。
  - 例如：`MFAScreenLockApp.exe -r Y8K2V-5J2ZL-F6QC8-ERFJ4-4HME8-POL50`